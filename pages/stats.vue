<script setup>
import { ref, onMounted } from "vue";

const totalHashrate = ref(0);
const totalShares = ref(0);

async function fetchStats() {
  const res = await fetch("/api/stats");
  const data = await res.json();
  totalHashrate.value = data.totalHashrate;
  totalShares.value = data.totalShares;
}

async function sendTestData() {
  await fetch("/api/stats", {
    method: "POST",
    headers: { "Content-Type": "application/json" },
    body: JSON.stringify({ hashrate: 50, shares: 1 }), // –¢–µ—Å—Ç–æ–≤—ã–µ –¥–∞–Ω–Ω—ã–µ
  });
  fetchStats(); // –û–±–Ω–æ–≤–∏—Ç—å –¥–∞–Ω–Ω—ã–µ –ø–æ—Å–ª–µ –æ—Ç–ø—Ä–∞–≤–∫–∏
}

onMounted(fetchStats);
</script>

<template>
  <div class="p-4">
    <h1 class="text-xl font-bold">–¢–µ—Å—Ç–æ–≤–∞—è —Å—Ç—Ä–∞–Ω–∏—Ü–∞</h1>
    <p>üåê –û–±—â–∏–π —Ö–µ—à—Ä–µ–π—Ç: {{ totalHashrate }}</p>
    <p>üíé –ù–∞–π–¥–µ–Ω–Ω—ã–µ —à–∞—Ä—ã: {{ totalShares }}</p>
    <button @click="sendTestData" class="mt-4 p-2 bg-blue-500 text-white rounded">
      –û—Ç–ø—Ä–∞–≤–∏—Ç—å —Ç–µ—Å—Ç–æ–≤—ã–µ –¥–∞–Ω–Ω—ã–µ
    </button>
  </div>
</template>
